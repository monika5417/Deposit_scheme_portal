package com.mpcz.deposit_scheme.backend.api.services.impl;

import java.math.BigDecimal;
import java.math.RoundingMode;
import java.util.Arrays;
import java.util.List;
import java.util.Objects;
import java.util.Optional;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.mpcz.deposit_scheme.backend.api.constant.HttpCode;
import com.mpcz.deposit_scheme.backend.api.constant.ResponseMessage;
import com.mpcz.deposit_scheme.backend.api.domain.ConsumerApplicationDetail;
import com.mpcz.deposit_scheme.backend.api.domain.ErpEstimateAmountData;
import com.mpcz.deposit_scheme.backend.api.domain.LoadRequested;
import com.mpcz.deposit_scheme.backend.api.domain.SchemeType;
import com.mpcz.deposit_scheme.backend.api.domain.WorkType;
import com.mpcz.deposit_scheme.backend.api.dto.ErpEstimateCalculatedDto;
import com.mpcz.deposit_scheme.backend.api.exception.ErpEstimateAmountException;
import com.mpcz.deposit_scheme.backend.api.repository.EstimateAmountRepository;
import com.mpcz.deposit_scheme.backend.api.response.Response;
import com.mpcz.deposit_scheme.backend.api.services.ConsumerApplicationDetailService;
import com.mpcz.deposit_scheme.backend.api.services.ErpEstimateAmountService;
import com.mpcz.deposit_scheme.backend.api.services.LoadRequestedService;
import com.mpcz.deposit_scheme.backend.api.services.SchemeTypeService;

//
@Service
public class ErpEstimateAmountServiceImpl implements ErpEstimateAmountService {

	Logger logger = LoggerFactory.getLogger(WorkTypeServiceImpl.class);

	@Autowired
	private EstimateAmountRepository estimateAmountRepository;

	@Autowired
	private ConsumerApplicationDetailService consumerApplicationDetailService;

	@Autowired
	private SchemeTypeService schemeTypeService;

	@Autowired
	private LoadRequestedService loadRequestedService;

	@Override
	public List<ErpEstimateAmountData> saveAllEstimateAmount(List<ErpEstimateAmountData> saveAllEstimateAmountList)
			throws ErpEstimateAmountException {
		// TODO Auto-generated method stub

		final String method = "ErpEstimateServiceImpl : saveWorkType()";
		logger.info(method);

		Response<ErpEstimateAmountData> response = new Response<>();

		WorkType workTypeResponse = null;

		if (saveAllEstimateAmountList.isEmpty()) {
			logger.error("ErpEstimate object is null");
			response.setCode(HttpCode.NULL_OBJECT);
			response.setMessage(ResponseMessage.NULL_OBJECT_MESSAGE);
			throw new ErpEstimateAmountException(response);
		} else {

			List<ErpEstimateAmountData> saveAll = estimateAmountRepository.saveAll(saveAllEstimateAmountList);

			if (Objects.isNull(saveAll)) {
				logger.error("repository.save(ErpEstimateAmount) is returning Null");
				response.setCode(HttpCode.NULL_OBJECT);
				response.setMessage(ResponseMessage.RECORD_INSERTION_FAILED_MESSAGE);
				throw new ErpEstimateAmountException(response);
			} else {
				return saveAll;
			}

		}

	}

	@Override
	public ErpEstimateAmountData findByEstimateNumber(String estimateNumber) throws ErpEstimateAmountException {

		final String method = "ApplicationTypeServiceImpl : findByEstimateNumber(Long applicationTypeId)";

		logger.info(method);

		final Optional<ErpEstimateAmountData> ErpEstimateDomainOptional = estimateAmountRepository
				.findById(estimateNumber);

		final Response<ErpEstimateAmountData> response = new Response<>();

		if (!ErpEstimateDomainOptional.isPresent()) {
//			logger.error("applicationTypeRepository.findById is returning Null when findByApplicationTypeId call");
//			response.setCode(HttpCode.NULL_OBJECT);
//			response.setMessage(ResponseMessage.APPLICATION_TYPE_RECORD_FETCH_BY_ID_FAILED_MESSAGE);
//			throw new ErpEstimateAmountException(response);
			return null;
		}
		ErpEstimateAmountData estimatekResponse = ErpEstimateDomainOptional.get();

		response.setList(Arrays.asList(estimatekResponse));
		logger.info("Response is returning successfully");
		response.setCode(HttpCode.OK);
		response.setMessage(ResponseMessage.RECORD_FETCH_BY_ID_MESSAGE);
		return estimatekResponse;

	}

	@Override
	public ErpEstimateCalculatedDto calculateEstimateAmount(Long consumerAppId) throws Exception {

		ErpEstimateCalculatedDto estimateAmountDto = new ErpEstimateCalculatedDto();
		ConsumerApplicationDetail consumerapplication = null;
		try {
			consumerapplication = consumerApplicationDetailService.findByConsumerApplicationId(consumerAppId);
		} catch (Exception e) {

			e.printStackTrace();
		}
		SchemeType schemeObject = schemeTypeService
				.findBySchemeTypeId(consumerapplication.getSchemeType().getSchemeTypeId());

		LoadRequested loadRequested = new LoadRequested();

		Optional<ErpEstimateAmountData> erpEstimateAmountDataOptional = estimateAmountRepository
				.findById(consumerapplication.getErpWorkFlowNumber());

		BigDecimal totalSupervisionAmount = null;
		BigDecimal totalDepositAmount = null;
		BigDecimal loadRequestedDouble = null;
		BigDecimal kvaLoadAmount = null;
		BigDecimal kwloads = null;

		ErpEstimateAmountData erpEstimateAmount = erpEstimateAmountDataOptional.get();

		BigDecimal supervisionAmount = roundAmountCgstAndSgst(erpEstimateAmount.getSupervisionAmount());

		BigDecimal superVisionDouble = roundAmountCgstAndSgst(erpEstimateAmount.getSupervisionAmount());

		String estimateAmount = erpEstimateAmount.getEstimateAmount();

		BigDecimal estimateAmountDouble = roundAmountCgstAndSgst(new BigDecimal(erpEstimateAmount.getEstimateAmount()));

		BigDecimal cgst = roundAmountCgstAndSgst(superVisionDouble.multiply(new BigDecimal(.09)));
		BigDecimal sgst = roundAmountCgstAndSgst(superVisionDouble.multiply(new BigDecimal(.09)));

		estimateAmountDto.setSgst(sgst);
		estimateAmountDto.setCgst(cgst);

		erpEstimateAmount.setCgst(cgst);
		erpEstimateAmount.setSgst(sgst);

		BigDecimal supervisionbalanceRemain = superVisionDouble;
		BigDecimal supervisionBalanceRemaining = supervisionbalanceRemain;

		estimateAmountDto.setSuperVisionAmount(superVisionDouble);

		erpEstimateAmount.setSupervisionAmount(supervisionAmount);
		erpEstimateAmount.setEstimateAmount(roundAmountCgstAndSgst(new BigDecimal(estimateAmount)) + "");

		if (schemeObject.getSchemeTypeName().equals("Supervision")
				&& erpEstimateAmountDataOptional.get().getSchemeCode().contains("SCCW")) {

			if (erpEstimateAmountDataOptional != null) {

				if (erpEstimateAmount.getSchema() != null
						&& erpEstimateAmount.getSchema().toUpperCase().contains("SCCW")) {

//					Colony Electrification(Illegal)
					if (consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 4) {
						String loadRequstedUnit = consumerapplication.getJeLoad();
						loadRequestedDouble = new BigDecimal(loadRequstedUnit);
//						400 matlb 400 tak hai ( yes aya hai front end se)

						double number = Double.parseDouble(loadRequstedUnit);

						if (consumerapplication.getIndividualOrGroup() != null
								&& consumerapplication.getIndividualOrGroup().getIndividualOrGroupId() == 1
								&& consumerapplication.getJeLoad() != null && number <= 400) {
							estimateAmountDto.setSgst(null);
							estimateAmountDto.setCgst(null);

							erpEstimateAmount.setCgst(null);
							erpEstimateAmount.setSgst(null);
							BigDecimal round = null;
//							charitra code start 

//								kw ke case me ye chalega
							round = roundAmountCgstAndSgst(loadRequestedDouble.multiply(new BigDecimal(15567)));

//					charitra end code
//							billdesk walo ko yahi amount beja ja raha hai
							erpEstimateAmount.setTotalBalanceSupervisionAmount(round11(round, 2));
							estimateAmountDto.setTotalamountOfSupervision(round11(round, 2));

							erpEstimateAmount.setColonyOrSlum(round);
							estimateAmountDto.setColonyOrSlum(round);

							estimateAmountDto.setSuperVisionAmount(null);

						} else {

							totalSupervisionAmount = supervisionBalanceRemaining.add(cgst).add(sgst);
							BigDecimal round = totalSupervisionAmount;
							erpEstimateAmount.setTotalBalanceSupervisionAmount(round11(round, 2));
							estimateAmountDto.setTotalamountOfSupervision(round11(round, 2));

						}

//                  NSC 
					} else if (consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 2) {
						BigDecimal jeReturnAmount = null;
					
						if (consumerapplication.getJeReturnAmount() == null) {
							jeReturnAmount = new BigDecimal(0.0);
						}
						else {
							jeReturnAmount = round111(consumerapplication.getJeReturnAmount(), 0);
						}
					

						totalSupervisionAmount = supervisionBalanceRemaining.add(cgst).add(sgst);
						BigDecimal round = roundAmountCgstAndSgst(totalSupervisionAmount.add(jeReturnAmount));
						erpEstimateAmount.setTotalBalanceSupervisionAmount(round11(round, 2));
						estimateAmountDto.setTotalamountOfSupervision(round11(round, 2));

						erpEstimateAmount.setJeReturnAmount(jeReturnAmount);
						estimateAmountDto.setJeReturnAmount(jeReturnAmount);

					}

//						Colony Electrification(Legal)
					else if (consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 3) {
						double i1 = Double.parseDouble(consumerapplication.getJeLoad());
						BigDecimal bigDecimal = new BigDecimal(consumerapplication.getJeLoad());

//						kva ke liye code
						if (consumerapplication.getJeLoadUnitKwYaKva().equals("KVA")) {
							if (i1 < 1500) {
								BigDecimal i = new BigDecimal(i1);
								kvaLoadAmount = bigDecimal.multiply(new BigDecimal(850));

								BigDecimal roundKvaLoad = round111(kvaLoadAmount, 0);

								totalSupervisionAmount = supervisionBalanceRemaining.add(cgst).add(sgst)
										.add(roundKvaLoad);
								BigDecimal round = round11(totalSupervisionAmount, 2);

								erpEstimateAmount.setKvaLoad(roundKvaLoad);
								erpEstimateAmount.setTotalBalanceSupervisionAmount(round);

								estimateAmountDto.setTotalamountOfSupervision(round);
								estimateAmountDto.setKvaLoadAmount(roundKvaLoad);
							} else {
								totalSupervisionAmount = supervisionBalanceRemaining.add(cgst).add(sgst);
								estimateAmountDto.setTotalamountOfSupervision(round11(totalSupervisionAmount, 2));
								erpEstimateAmount.setTotalBalanceSupervisionAmount(round11(totalSupervisionAmount, 2));
							}

						}

					}

					// Nature of work id 1,6 and 7 k liye
					else {
						BigDecimal jeReturnAmt = round111(consumerapplication.getJeReturnAmount(), 0);
						if (jeReturnAmt != null) {
							totalSupervisionAmount = supervisionBalanceRemaining.add(cgst).add(sgst)
									.add(consumerapplication.getJeReturnAmount());

							estimateAmountDto.setJeReturnAmount(jeReturnAmt);
							erpEstimateAmount.setJeReturnAmount(jeReturnAmt);

							estimateAmountDto.setTotalamountOfSupervision(round11(totalSupervisionAmount, 2));
							erpEstimateAmount.setTotalBalanceSupervisionAmount(round11(totalSupervisionAmount, 2));
						}

						else {
							totalSupervisionAmount = supervisionBalanceRemaining.add(cgst).add(sgst);
							estimateAmountDto.setTotalamountOfSupervision(round11(totalSupervisionAmount, 2));
							erpEstimateAmount.setTotalBalanceSupervisionAmount(round11(totalSupervisionAmount, 2));

						}
					}
					estimateAmountRepository.save(erpEstimateAmount);
					return estimateAmountDto;
				} else {
					throw new Exception("Estimate Scheme not Matched");

				}
			}

		} else if (schemeObject.getSchemeTypeName().equals("Deposit")
				&& erpEstimateAmountDataOptional.get().getSchemeCode().equalsIgnoreCase("DEPOSITE")) {

			BigDecimal supervisionAmountDouble = roundAmountCgstAndSgst(erpEstimateAmount.getSupervisionAmount());
			BigDecimal dbMinusCost = new BigDecimal(0.0);
			
			if (erpEstimateAmount.getMinusCost() != null) {
				dbMinusCost =roundAmountCgstAndSgst( erpEstimateAmount.getMinusCost());
			}
			BigDecimal depositAmount = estimateAmountDouble.subtract(dbMinusCost).subtract(supervisionAmountDouble)
					.subtract(cgst).subtract(sgst);
			BigDecimal round2 = roundAmountCgstAndSgst(depositAmount);

//			monika code start for adding supervision+deposit+cgst+sgst
			BigDecimal totalEstimateAmount = roundAmountCgstAndSgst(supervisionAmountDouble.add(round2).add(cgst).add(sgst));
			
			erpEstimateAmount.setMinusCost(dbMinusCost);
			estimateAmountDto.setMinusCost(dbMinusCost);
//			code end
			estimateAmountDto.setDepositAmount(round2);
			estimateAmountDto.setSuperVisionAmount(supervisionAmountDouble);

			erpEstimateAmount.setDepositAmount(round2);
//			erpEstimateAmount.setBalanceDepositAmount(round2);

			// kwload and kva load logic

			if (consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 1
					|| consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 6
					|| consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 7) {
//				isme data save karna hai her condition me isse hi data uth kar jayega bill desk walo ke pass

				BigDecimal jeReturnAmount = round111(consumerapplication.getJeReturnAmount(), 0);
				if (jeReturnAmount != null) {
//					BigDecimal returnAddAmount = roundAmountCgstAndSgst(
//							estimateAmountDouble.add(jeReturnAmount).subtract(dbMinusCost));

					BigDecimal returnAddAmount = roundAmountCgstAndSgst(
							totalEstimateAmount.add(jeReturnAmount));
					
					estimateAmountDto.setJeReturnAmount(jeReturnAmount);
					erpEstimateAmount.setJeReturnAmount(jeReturnAmount);

					erpEstimateAmount.setTotalBalanceDepositAmount(returnAddAmount);
					estimateAmountDto.setTotaldepositAmount(returnAddAmount);
					
					erpEstimateAmount.setMinusCost(dbMinusCost);
					estimateAmountDto.setMinusCost(dbMinusCost);
					
				} else {
//					erpEstimateAmount.setTotalBalanceDepositAmount(estimateAmountDouble.subtract(dbMinusCost));
//					estimateAmountDto.setTotaldepositAmount(estimateAmountDouble.subtract(dbMinusCost));
					
					erpEstimateAmount.setTotalBalanceDepositAmount(totalEstimateAmount);
					estimateAmountDto.setTotaldepositAmount(totalEstimateAmount);
				}
			}

			else if (consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 2) {

				BigDecimal jeReturnAmount = round111(consumerapplication.getJeReturnAmount(), 0);
				if (jeReturnAmount == null) {
					jeReturnAmount = new BigDecimal(0.0);
				}
//				BigDecimal returnEstimate = roundAmountCgstAndSgst(estimateAmountDouble.add(jeReturnAmount));
				BigDecimal returnEstimate = roundAmountCgstAndSgst(totalEstimateAmount.add(jeReturnAmount));

				erpEstimateAmount.setTotalBalanceDepositAmount(returnEstimate);
				erpEstimateAmount.setSgst(sgst);
				erpEstimateAmount.setCgst(cgst);
				estimateAmountDto.setTotaldepositAmount(returnEstimate);

				erpEstimateAmount.setJeReturnAmount(jeReturnAmount);
				estimateAmountDto.setJeReturnAmount(jeReturnAmount);
			}

//			Colony Electrification(Legal)

			else if (consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 3) {

				double i1 = Double.parseDouble(consumerapplication.getJeLoad());
				BigDecimal bigDecimal = new BigDecimal(consumerapplication.getJeLoad());

				if (consumerapplication.getJeLoadUnitKwYaKva().equals("KVA")) {
					if (i1 < 1500) {
						BigDecimal i = new BigDecimal(i1);
						kvaLoadAmount = bigDecimal.multiply(new BigDecimal(850));

						BigDecimal roundKvaLoad = round111(kvaLoadAmount, 0);

//						totalDepositAmount = estimateAmountDouble.add(roundKvaLoad);
						totalDepositAmount = totalEstimateAmount.add(roundKvaLoad);
						BigDecimal round = roundAmountCgstAndSgst(totalDepositAmount);

						erpEstimateAmount.setKvaLoad(roundKvaLoad);
						erpEstimateAmount.setTotalBalanceDepositAmount(round);

						estimateAmountDto.setTotaldepositAmount(round);
						estimateAmountDto.setKvaLoadAmount(roundKvaLoad);

					} else {
//						totalDepositAmount = estimateAmountDouble;
						totalDepositAmount = totalEstimateAmount;
						estimateAmountDto.setTotaldepositAmount(totalDepositAmount);
						erpEstimateAmount.setTotalBalanceDepositAmount(totalDepositAmount);
					}

				} 
//				else {
////					kw ke liye code			
////					400 kw 500 kva      
////                    1200 kw 1500kva			
//
//					if (i1 < 1500) {
//						BigDecimal i = new BigDecimal(i1);
//						BigDecimal bigDecimal1 = new BigDecimal(consumerapplication.getJeLoad());
//						kvaLoadAmount = bigDecimal1.multiply(new BigDecimal(850));
//
//						BigDecimal roundKvaLoad = round111(kvaLoadAmount, 0);
//
//						totalDepositAmount = round2.add(roundKvaLoad);
////						totalDepositAmount = totalEstimateAmount.add(roundKvaLoad);
//						BigDecimal round = totalDepositAmount;
//
//						erpEstimateAmount.setKvaLoad(roundKvaLoad);
//						erpEstimateAmount.setTotalBalanceDepositAmount(round);
//
//						estimateAmountDto.setTotaldepositAmount(round);
//						estimateAmountDto.setKvaLoadAmount(roundKvaLoad);
//					} else {
////						totalDepositAmount = estimateAmountDouble;
//						totalDepositAmount = totalEstimateAmount;
//						estimateAmountDto.setTotaldepositAmount(totalDepositAmount);
//						erpEstimateAmount.setTotalBalanceDepositAmount(totalDepositAmount);
//					}
//				}

			} else if (consumerapplication.getNatureOfWorkType().getNatureOfWorkTypeId() == 4) {
				String loadRequstedUnit = consumerapplication.getJeLoad();
				double load = Double.valueOf(loadRequstedUnit);
				loadRequestedDouble = new BigDecimal(load);

				if (loadRequestedDouble != null && consumerapplication.getJeLoadUnitKwYaKva().equalsIgnoreCase("KW")) {

					if (load <= 400 && consumerapplication.getIndividualOrGroup() != null
							&& consumerapplication.getIndividualOrGroup().getIndividualOrGroupId() == 1) {
						kwloads = round111(loadRequestedDouble.multiply(new BigDecimal(15567)), 0);

						erpEstimateAmount.setColonyOrSlum(kwloads);
						erpEstimateAmount.setSgst(null);
						erpEstimateAmount.setCgst(null);

						estimateAmountDto.setColonyOrSlum(kwloads);
						estimateAmountDto.setCgst(null);
						estimateAmountDto.setSgst(null);
						estimateAmountDto.setSuperVisionAmount(null);
						estimateAmountDto.setDepositAmount(null);
						totalDepositAmount = kwloads;
						erpEstimateAmount.setTotalBalanceDepositAmount(kwloads);
						estimateAmountDto.setTotaldepositAmount(kwloads);
					} else {
						totalDepositAmount = estimateAmountDouble;
						BigDecimal round = totalDepositAmount;

						erpEstimateAmount.setTotalBalanceDepositAmount(round);
						estimateAmountDto.setTotaldepositAmount(round);
					}

				}

			}

			estimateAmountRepository.save(erpEstimateAmount);
			return estimateAmountDto;

		} else if (schemeObject.getSchemeTypeName().equals("Departmental (MPMKVVCL)"))

		{

			BigDecimal oytAmount = estimateAmountDouble.add(cgst).add(sgst);
			BigDecimal parikshan = oytAmount.multiply(new BigDecimal(.03));
			BigDecimal parikshanCgst = parikshan.multiply(new BigDecimal(.09));
			BigDecimal parikshanMpgst = parikshan.multiply(new BigDecimal(.09));
			BigDecimal finalOyt = parikshan.add(parikshanMpgst).add(parikshanMpgst);
			BigDecimal finalOytDouble = finalOyt;
			BigDecimal finalparikshanCgst = parikshanCgst;
			BigDecimal parikshanAmount = parikshan;

			erpEstimateAmount.setTotalOytAmount(finalOyt);
			erpEstimateAmount.setCgst(parikshanCgst);
			erpEstimateAmount.setSgst(parikshanMpgst);
			erpEstimateAmount.setPrayakshanShulk(parikshan);
			estimateAmountDto.setParikshanCgst(finalparikshanCgst);
			estimateAmountDto.setPrayakshanShulk(parikshanAmount);
			estimateAmountDto.setFinalOyt(finalOytDouble);

			ErpEstimateAmountData save = estimateAmountRepository.save(erpEstimateAmount);
			return estimateAmountDto;
		} else if (schemeObject.getSchemeTypeName().equals("Supervision")
				&& erpEstimateAmountDataOptional.get().getSchemeCode().contains("OYT")) {

			if (erpEstimateAmountDataOptional != null) {

				estimateAmountDto = new ErpEstimateCalculatedDto();

				if (erpEstimateAmount.getSchema() != null
						&& erpEstimateAmount.getSchema().toUpperCase().contains("OYT")) {

					estimateAmountDto.setSgst(sgst);
					estimateAmountDto.setCgst(cgst);

					erpEstimateAmount.setCgst(cgst);
					erpEstimateAmount.setSgst(sgst);
					BigDecimal round = superVisionDouble.add(cgst).add(sgst);

					estimateAmountDto.setSuperVisionAmount(supervisionAmount);
					estimateAmountDto.setTotalamountOfSupervision(round11(round, 2));

					erpEstimateAmount.setTotalBalanceSupervisionAmount(round11(round, 2));

					estimateAmountRepository.save(erpEstimateAmount);
					return estimateAmountDto;
				} else {
//				throw new Exception("Estimate Scheme not Matched");

				}
			}

		} else {
//		throw new Exception("Estimate Scheme not Matched");

		}

		return null;
	}

	public static double round(double value, int places) {
		if (places < 0)
			throw new IllegalArgumentException();
		BigDecimal bd = BigDecimal.valueOf(value);
		bd = bd.setScale(2, RoundingMode.CEILING);
		return bd.doubleValue();
	}

//
//	public static double round1(double value, int places) {
//		if (places < 0)
//			throw new IllegalArgumentException();																																																																																																																																																																																																																																																																																																																																																										
//		BigDecimal bd = BigDecimal.valueOf(value);
//		bd = bd.setScale(0, RoundingMode.CEILING);
//		return bd.doubleValue();
//	}
//
	public static BigDecimal round0(BigDecimal value, int places) {
		if (places < 0)
			throw new IllegalArgumentException();
		BigDecimal bd = value;
		bd = bd.setScale(2, RoundingMode.CEILING);
		return bd;
	}

//
	public static BigDecimal round11(BigDecimal value, int places) {
		if (places < 0)
			throw new IllegalArgumentException();
		BigDecimal bd = value;
		bd = bd.setScale(2, RoundingMode.CEILING);
		return bd;
	}

	public static BigDecimal round111(BigDecimal value, int places) {
		if (places < 0)
			throw new IllegalArgumentException();
		BigDecimal bd = value;
		bd = bd.setScale(places, RoundingMode.CEILING);
		return bd;
	}

	public static BigDecimal roundAmountCgstAndSgst(BigDecimal amount) {
		BigDecimal roundedAmount = amount.setScale(0, RoundingMode.FLOOR); // Get the integer part

		BigDecimal remainingPaise = amount.subtract(roundedAmount); // Get the decimal part (paise)

		if (remainingPaise.compareTo(new BigDecimal(0.5)) >= 0) {
			roundedAmount = roundedAmount.add(BigDecimal.ONE); // Round up if paise is 50 or more
		}
		return roundedAmount;
	}
}