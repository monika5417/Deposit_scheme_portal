package com.mpcz.deposit_scheme.backend.api.controller;

import java.text.MessageFormat;
import java.text.SimpleDateFormat;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Optional;

import org.json.JSONArray;
import org.json.JSONObject;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.HttpClientErrorException;
import org.springframework.web.client.RestTemplate;

import com.mpcz.deposit_scheme.backend.api.constant.ResponseMessage;
import com.mpcz.deposit_scheme.backend.api.domain.ApplicationStatus;
import com.mpcz.deposit_scheme.backend.api.domain.BillDeskPaymentResponse;
import com.mpcz.deposit_scheme.backend.api.domain.ConsumerApplicationDetail;
import com.mpcz.deposit_scheme.backend.api.domain.ContractorForBidWorkStatus;
import com.mpcz.deposit_scheme.backend.api.domain.ErpEstimateAmountData;
import com.mpcz.deposit_scheme.backend.api.domain.MmkyPayAmount;
import com.mpcz.deposit_scheme.backend.api.domain.PoseMachinePostData;
import com.mpcz.deposit_scheme.backend.api.enums.ApplicationStatusEnum;
import com.mpcz.deposit_scheme.backend.api.repository.ApplicationStatusRepository;
import com.mpcz.deposit_scheme.backend.api.repository.BillPaymentResponseeeeeeeRepository;
import com.mpcz.deposit_scheme.backend.api.repository.ConsumerApplictionDetailRepository;
import com.mpcz.deposit_scheme.backend.api.repository.ContractorForBidWorkStatusRepository;
import com.mpcz.deposit_scheme.backend.api.repository.EstimateAmountRepository;
import com.mpcz.deposit_scheme.backend.api.repository.MmkyPayAmountRespository;
import com.mpcz.deposit_scheme.backend.api.repository.PoseMachinePostDataRepository;
import com.mpcz.deposit_scheme.backend.api.request.SMSRequest;
import com.mpcz.deposit_scheme.backend.api.response.Response;
import com.mpcz.deposit_scheme.backend.api.services.ApplicationStatusService;
import com.mpcz.deposit_scheme.backend.api.services.SMSDirectService;
import com.mpcz.deposit_scheme.backend.api.utility.MessageProperties;

@RequestMapping("/scheduler")
@RestController
public class AllScheduler {

	@Autowired
	private BillPaymentResponseeeeeeeRepository billPaymentResponseeeeeeeRepository;

	@Autowired
	private MmkyPayAmountRespository mmkyPayAmountRespository;

	@Autowired
	ConsumerApplictionDetailRepository consumerApplictionDetailRepository;

	@Autowired
	private ApplicationStatusService applicationStatusService;

	@Autowired
	private MessageProperties messageProperties;

	@Autowired
	private SMSDirectService smsDirectService;

	@Autowired
	private ApplicationStatusRepository applicationStatusRepository;

	@Autowired
	EstimateAmountRepository estimateAmountRepository;

	@Autowired
	private PoseMachinePostDataRepository poseMachinePostDate;

	@Autowired
	private ConsumerApplictionDetailRepository consumerApplicationDetailRepository;

	@Autowired
	ContractorForBidWorkStatusRepository contractorForBidWorkStatusRepository;
//
//	@GetMapping("/demandFees")
//	@Scheduled(fixedRate = 60000)
//	public void AdditionalInfoSetDemandFees() {
//
//		billPaymentResponseeeeeeeRepository.AdditionalInfoSetDemandFees().stream().forEach(bill -> {
//			bill.setAdditionalInfo("Demand_fees");
//			System.out.println(bill.getConsumerApplicationNo());
//			billPaymentResponseeeeeeeRepository.save(bill);
//		});
//	}
//
////	@GetMapping("/RegistrationFees")
//	@Scheduled(fixedRate = 60000)
//	public void AdditionalInfoSetRegistrationFees() {
//
//		billPaymentResponseeeeeeeRepository.AdditionalInfoSetRegistrationFees().stream().forEach(bill -> {
//			bill.setAdditionalInfo("Registration_Fees");
//			System.out.println(bill.getConsumerApplicationNo());
//			billPaymentResponseeeeeeeRepository.save(bill);
//		});
//	}
//
//	// Monika code start
//
////	 @GetMapping("/deActiveAppAfter30Days")
//	@Scheduled(fixedRate = 86400000)
//	public void deActiveAppAfter30Days() {
//		Response<Object> response = new Response<Object>();
//		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
//		Date date = new Date();
//		String s = formatter.format(date);
//
//		System.out.println(s);
//
//		List<MmkyPayAmount> findAll = mmkyPayAmountRespository.findAll();
//		for (MmkyPayAmount M : findAll) {
//
//			LocalDate dbDate = LocalDate.parse(M.getCreated());
//
//			LocalDate currentDate1 = dbDate.plusDays(30);
//			LocalDate date2 = LocalDate.parse(s);
//
//			if (currentDate1.compareTo(date2) < 0) {
//				List<BillDeskPaymentResponse> findByConsumerApplicationNo = billPaymentResponseeeeeeeRepository
//						.findByConsumerApplicationNo(M.getConsumerApplicationNumber());
//				if (findByConsumerApplicationNo.isEmpty()) {
//					M.setActive(false);
//					M.setDeleted(true);
//					System.out.println(M.getConsumerApplicationNumber());
//					ConsumerApplicationDetail findByConsumerApplicationNumber = consumerApplictionDetailRepository
//							.findByConsumerApplicationNumber(M.getConsumerApplicationNumber());
//					if (findByConsumerApplicationNumber != null) {
//						findByConsumerApplicationNumber.setActive(false);
//						findByConsumerApplicationNumber.setDeleted(true);
//						ApplicationStatus applicationStatus = applicationStatusService.findById(
//								ApplicationStatusEnum.APPLICATION_REJECTED_DEMAND_NOTE_PAYMENT_NOT_DONE_WITHIN_30_DAYS
//										.getId());
//						findByConsumerApplicationNumber.setApplicationStatus(applicationStatus);
//						consumerApplictionDetailRepository.save(findByConsumerApplicationNumber);
//					}
//				}
//
//				mmkyPayAmountRespository.save(M);
//			}
//		}
//
//	}
//
////	 @GetMapping("/mkmyMsgAfter25Days")
//	@Scheduled(fixedRate = 86400000)
//	public void mkmyMsgAfter25Days() {
//		Response<Object> response = new Response<Object>();
//		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
//		Date date = new Date();
//		String s = formatter.format(date);
//
//		System.out.println(s);
//
//		List<MmkyPayAmount> findAll = mmkyPayAmountRespository.findAllUnsendMsg();
//		for (MmkyPayAmount M : findAll) {
//
//			ConsumerApplicationDetail consumerapplication = consumerApplictionDetailRepository
//					.findByConsumerApplicationNumber(M.getConsumerApplicationNumber());
//
//			LocalDate dbDate = LocalDate.parse(M.getCreated());
//
//			LocalDate currentDate1 = dbDate.plusDays(25);
//			LocalDate date2 = LocalDate.parse(s);
//
//			if (currentDate1.compareTo(date2) == 0) {
//				List<BillDeskPaymentResponse> findByConsumerApplicationNo = billPaymentResponseeeeeeeRepository
//						.findByConsumerApplicationNo(M.getConsumerApplicationNumber());
//
//				System.out.println("consumer_application" + M.getConsumerApplicationNumber());
//				System.out.println("consumer_demand date" + currentDate1);
//				if (findByConsumerApplicationNo.isEmpty()) {
//					final SMSRequest smsRequest = new SMSRequest();
//
//					smsRequest.setText(MessageFormat.format(messageProperties.getMkmyPaymentRemainFiveDay(),
//							new Object[] { M.getConsumerApplicationNumber() }));
//					smsRequest.setMobileNo(consumerapplication.getConsumers().getConsumerLoginId());
//					smsRequest.setTemplateId(messageProperties.getMkmyPaymentRemainTempId());
//
//					try {
//						String sendMessage = smsDirectService.sendMessage(smsRequest);
//						if (!sendMessage.equalsIgnoreCase(null)) {
//							M.setMsgSend("Send");
//							mmkyPayAmountRespository.save(M);
//						}
//
//					} catch (Exception e) {
//						e.printStackTrace();
//					}
//				}
//			}
//		}
//
//	}
//
////	@GetMapping("/getAllOytPaymentDatePendingApplication")
//	@Scheduled(fixedRate = 86400000)
//	public ResponseEntity<?> getAllOytPaymentDatePendingApplication() {
//		Response response = new Response();
//
//		List<ConsumerApplicationDetail> findAllOytApplication = consumerApplictionDetailRepository
//				.findAllOytApplication();
//		if (findAllOytApplication.isEmpty()) {
//			response.setCode(ResponseMessage.NOT_FOUND);
//			response.setMessage("No Oyt application found for filling payment date ");
//			return ResponseEntity.ok().header(ResponseMessage.APPLICATION_TYPE_JSON).body(response);
//		}
//
//		for (ConsumerApplicationDetail consumerApplicationDetail : findAllOytApplication) {
//
//			List<BillDeskPaymentResponse> findByConsumerApplicationNo = billPaymentResponseeeeeeeRepository
//					.findByConsumerApplicationNo(consumerApplicationDetail.getConsumerApplicationNo());
//			findByConsumerApplicationNo.stream().filter(a -> a.getAuth_status().equalsIgnoreCase("0300")
//					&& a.getAdditionalInfo().equalsIgnoreCase("Demand_fees")).forEach(b -> {
//						String transactionDate = b.getTransactionDate();
//						System.out.println("Dateeeeeeeeee   " + transactionDate);
//
//						String dateString = transactionDate;
//
//						// Parse the string to LocalDateTime
//						LocalDateTime dateTime = LocalDateTime.parse(dateString,
//								DateTimeFormatter.ISO_OFFSET_DATE_TIME);
//
//						// Format the LocalDateTime to desired format
//						String formattedDate = dateTime.format(DateTimeFormatter.ofPattern("dd-MM-yyyy"));
//
//						// Print the formatted date
//						System.out.println("Formatted Date: " + formattedDate);
//
//						LocalDateTime modifiedDateTime = dateTime.plusDays(3);
//
//						// Format the modified date
//						String modifiedFormattedDate = modifiedDateTime
//								.format(DateTimeFormatter.ofPattern("dd-MM-yyyy"));
//
//						consumerApplicationDetail.setPaymentDate(modifiedFormattedDate);
//						ConsumerApplicationDetail save = consumerApplictionDetailRepository
//								.save(consumerApplicationDetail);
//
//					});
//
//		}
//
//		return null;
//	}
//
//	@GetMapping("/RegistrationFeesNotDoneRevertApp")
//	@Scheduled(fixedRate = 86400000)
//	public void RegistrationFeesNotDoneRevertApp() {
//		List<ConsumerApplicationDetail> registrationFeesNotDoneRevertApp = consumerApplictionDetailRepository
//				.RegistrationFeesNotDoneRevertApp();
//		registrationFeesNotDoneRevertApp.stream().forEach(n -> n.setApplicationStatus(applicationStatusRepository
//				.findById(ApplicationStatusEnum.PENDING_FOR_REGISTRATION_FEES.getId()).get()));
//		consumerApplictionDetailRepository.saveAll(registrationFeesNotDoneRevertApp);
//	}
//
//	@GetMapping("/RavindraSendDataForContractorSelectinon/{date}")
////	@Scheduled(fixedRate = 300000)
//	public void RavindraSendDataForContractorSelectinon(@PathVariable String date) {
////		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
////		Date date = new Date();
////		String s = formatter.format(date);
////		System.out.println(s+"datesdfhsdyertyuwe5ue4rtuerie5rdyietdftuj");
//		List<BillDeskPaymentResponse> ravindraSendDataForContractorSelectinon = billPaymentResponseeeeeeeRepository
//				.RavindraSendDataForContractorSelectinon(date);
//
//		ravindraSendDataForContractorSelectinon.stream().forEach(bill -> {
//
//			ConsumerApplicationDetail findByConsumerApplicationNumber = consumerApplictionDetailRepository
//					.findByConsumerApplicationNumber(bill.getConsumerApplicationNo());
////			ErpEstimateAmountData findById = estimateAmountRepository.findById(findByConsumerApplicationNumber.getErpWorkFlowNumber()).get();
//
//			Map<String, String> requestBody = new HashMap();
//
//			if (findByConsumerApplicationNumber.getNatureOfWorkType().getNatureOfWorkTypeId() == 8L) {
//				MmkyPayAmount findByConsumer = mmkyPayAmountRespository
//						.findByConsumerApplicationNumber(findByConsumerApplicationNumber.getConsumerApplicationNo());
//				requestBody.put("consumerApplicationNo", findByConsumerApplicationNumber.getConsumerApplicationNo());
//				requestBody.put("schema", findByConsumer.getSchemeCode());
//			} else {
//
//				Optional<ErpEstimateAmountData> findById1 = estimateAmountRepository
//						.findById(findByConsumerApplicationNumber.getErpWorkFlowNumber());
//				if (findById1.isPresent()) {
//					ErpEstimateAmountData erpEstimateAmountData = findById1.get();
//					String kwLoad = String.valueOf(erpEstimateAmountData.getKwLoad());
//					requestBody.put("kwload", kwLoad);
//
//					String kvaLoad = String.valueOf(erpEstimateAmountData.getKvaLoad());
//					requestBody.put("kvaload", kvaLoad);
//
//					String depositAmount = String.valueOf(erpEstimateAmountData.getDepositAmount());
//					requestBody.put("deposit_amount", depositAmount);
//
//					String superVisionAmt = String.valueOf(erpEstimateAmountData.getSupervisionAmount());
//					requestBody.put("supervision_amount", superVisionAmt);
//
//					String sgst = String.valueOf(erpEstimateAmountData.getSgst());
//					requestBody.put("sgst", sgst);
//
//					String cgst = String.valueOf(erpEstimateAmountData.getCgst());
//					requestBody.put("cgst", cgst);
//
//					requestBody.put("estimate_name", erpEstimateAmountData.getEstimateName());
//					requestBody.put("schema", erpEstimateAmountData.getSchemeCode());
//
//				}
//			}
//
//			requestBody.put("consumer_mobile_no", findByConsumerApplicationNumber.getConsumers().getConsumerMobileNo());
//			requestBody.put("consumerApplicationNo", findByConsumerApplicationNumber.getConsumerApplicationNo());
//			requestBody.put("consumer_email_id", findByConsumerApplicationNumber.getConsumers().getConsumerEmailId());
//
//			requestBody.put("address", findByConsumerApplicationNumber.getAddress());
//
//			requestBody.put("shortDescriptionOfWork", findByConsumerApplicationNumber.getShortDescriptionOfWork());
//			requestBody.put("erp_no", findByConsumerApplicationNumber.getErpWorkFlowNumber());
//			requestBody.put("consumerName", findByConsumerApplicationNumber.getConsumerName());
//			requestBody.put("is_bid_submitted", "false");
//
//			RestTemplate restTemplate = new RestTemplate();
//
////        Production Code
//			try {
//				ResponseEntity<Map> postForEntity = restTemplate
//						.postForEntity("https://qcportal.mpcz.in/tkc/get_consumer/", requestBody, Map.class);
//				System.out.println("The result of Post api is :" + postForEntity.getBody());
//			} catch (Exception e) {
//				e.printStackTrace();
//			}
//		});
//
//	}
////monika code end
//
////	@GetMapping("/RavindraSendDataForContractorSelectinonBYPoseMachine")
//	@Scheduled(fixedRate = 300000)
//	public void RavindraSendDataForContractorSelectinonBYPoseMachine() {
//		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
//		Date date = new Date();
//		String s = formatter.format(date);
//		System.out.println(s + "datesdfhsdyertyuwe5ue4rtuerie5rdyietdftuj");
//
//		List<PoseMachinePostData> ravindraSendDataForContractorSelectinon = poseMachinePostDate.findAll();
//		ravindraSendDataForContractorSelectinon.stream().forEach(bill -> {
//
//			ConsumerApplicationDetail findByConsumerApplicationNumber = consumerApplictionDetailRepository
//					.findByConsumerApplicationNumber(bill.getApplicationNumber());
////			ErpEstimateAmountData findById = estimateAmountRepository.findById(findByConsumerApplicationNumber.getErpWorkFlowNumber()).get();
//
//			Map<String, String> requestBody = new HashMap();
//			System.out.println(s + "datesdfhsdyertyuwe5ue4rtuerie5rdyietdftuj");
//			if (findByConsumerApplicationNumber.getNatureOfWorkType().getNatureOfWorkTypeId() == 8L) {
//				MmkyPayAmount findByConsumer = mmkyPayAmountRespository
//						.findByConsumerApplicationNumber(findByConsumerApplicationNumber.getConsumerApplicationNo());
//				requestBody.put("consumerApplicationNo", findByConsumerApplicationNumber.getConsumerApplicationNo());
//				requestBody.put("schema", findByConsumer.getSchemeCode());
//			} else {
//
//				Optional<ErpEstimateAmountData> findById1 = estimateAmountRepository
//						.findById(findByConsumerApplicationNumber.getErpWorkFlowNumber());
//				if (findById1.isPresent()) {
//					ErpEstimateAmountData erpEstimateAmountData = findById1.get();
//					String kwLoad = String.valueOf(erpEstimateAmountData.getKwLoad());
//					requestBody.put("kwload", kwLoad);
//
//					String kvaLoad = String.valueOf(erpEstimateAmountData.getKvaLoad());
//					requestBody.put("kvaload", kvaLoad);
//
//					String depositAmount = String.valueOf(erpEstimateAmountData.getDepositAmount());
//					requestBody.put("deposit_amount", depositAmount);
//
//					String superVisionAmt = String.valueOf(erpEstimateAmountData.getSupervisionAmount());
//					requestBody.put("supervision_amount", superVisionAmt);
//
//					String sgst = String.valueOf(erpEstimateAmountData.getSgst());
//					requestBody.put("sgst", sgst);
//
//					String cgst = String.valueOf(erpEstimateAmountData.getCgst());
//					requestBody.put("cgst", cgst);
//
//					requestBody.put("estimate_name", erpEstimateAmountData.getEstimateName());
//					requestBody.put("schema", erpEstimateAmountData.getSchemeCode());
//
//				}
//			}
//
//			requestBody.put("consumer_mobile_no", findByConsumerApplicationNumber.getConsumers().getConsumerMobileNo());
//			requestBody.put("consumerApplicationNo", findByConsumerApplicationNumber.getConsumerApplicationNo());
//			requestBody.put("consumer_email_id", findByConsumerApplicationNumber.getConsumers().getConsumerEmailId());
//
//			requestBody.put("address", findByConsumerApplicationNumber.getAddress());
//
//			requestBody.put("shortDescriptionOfWork", findByConsumerApplicationNumber.getShortDescriptionOfWork());
//			requestBody.put("erp_no", findByConsumerApplicationNumber.getErpWorkFlowNumber());
//			requestBody.put("consumerName", findByConsumerApplicationNumber.getConsumerName());
//			requestBody.put("is_bid_submitted", "false");
//
//			RestTemplate restTemplate = new RestTemplate();
//
////        Production Code
//			try {
//				ResponseEntity<Map> postForEntity = restTemplate
//						.postForEntity("https://qcportal.mpcz.in/tkc/get_consumer/", requestBody, Map.class);
//				System.out.println("The result of Post api is :" + postForEntity.getBody());
//			} catch (Exception e) {
//				e.printStackTrace();
//			}
//		});
//
//	}
//
////	 This method will run every 24 hours
//////    @Scheduled(fixedRate = 86400000) 
	@GetMapping("/saveContractorExpectedDates")
	public ResponseEntity<String> getBidNotParticipatedDocs() {
		RestTemplate restTemplate = new RestTemplate();

//		UAT
//		String url = "https://qcdev.mpcz.in:8080/tkc/bid_not_participated_docs";

//		PROD
		String url = "https://qcportal.mpcz.in/tkc/bid_not_participated_docs";

		try {
			ResponseEntity<String> response = restTemplate.getForEntity(url, String.class);
			String responseBody = response.getBody();
//			System.out.println("responseBody : " + responseBody);

			int notActionedCount = 0;
			int rejectedCount = 0;
			int acceptedCount = 0;

			if (responseBody != null) {
				List<ConsumerApplicationDetail> saveContractorExpectedDates = consumerApplicationDetailRepository
						.saveContractorExpectedDates();

				JSONArray dataArray = new JSONObject(responseBody).getJSONArray("data");
				for (ConsumerApplicationDetail consumerApp : saveContractorExpectedDates) {
					String consumerApplicationNo = consumerApp.getConsumerApplicationNo();
					boolean applicationFound = false;

					for (int i = 0; i < dataArray.length(); i++) {
						JSONObject item = dataArray.getJSONObject(i);
						String consumerApplicationNumber = item.getString("consumer_application_no");

						if (consumerApplicationNo.equals(consumerApplicationNumber)) {
							applicationFound = true;

							if (item.getString("is_rejected").equals("null")) {
								System.out.println(
										"Contractor did not take the action on application : " + consumerApplicationNo);
								notActionedCount++;
							} else if (item.getString("is_rejected").equals("true")) {
								System.out.println(
										"The application is rejected by contractor : " + consumerApplicationNo);
								rejectedCount++;
							} else if (item.getString("is_rejected").equals("false")) {
								acceptedCount++;

//								System.out.println(
//										"The application is Accepted by contractor : " + consumerApplicationNo);
								String workStartDate = item.getString("contractor_work_started");
								String materialHandover = item.getString("material_handover_site");
								String materialInstallationStart = item.getString("material_installation_start");
								String materialInstallationFinish = item.getString("material_installation_finished");
								String workCompletion = item.getString("expected_work_completion_date");

								 System.out.println("workStartDate fraaaaaaaa: " + workStartDate);
								  if (!workStartDate.equals("null") ) {

			                                acceptedCount++;
			                                System.out.println(
			                                        "The application is Accepted by contractor : " + consumerApplicationNo);
			                                System.out.println("workStartDate : " + workStartDate);
			                                System.out.println("materialHandover : " + materialHandover);
			                                System.out.println("materialInstallationStart : " + materialInstallationStart);
			                                System.out.println("materialInstallationFinish : " + materialInstallationFinish);
			                                System.out.println("expected workCompletion : " + workCompletion);

			                                // Save the contractorForBidWorkStatus as needed

			                                // Update the application status as needed
			                            } else {
			                                System.out.println(
			                                        "Accepted application has missing dates for consumerApplicationNo: " + consumerApplicationNo);
			                            }

//								ContractorForBidWorkStatus contractorForBidWorkStatus = new ContractorForBidWorkStatus();
//								contractorForBidWorkStatus.setConsumerApplicationNumber(consumerApplicationNo);
//								contractorForBidWorkStatus
//										.setMaterialHandoverSiteDate(item.getString("material_handover_site"));
//								contractorForBidWorkStatus
//										.setMaterialInstallFinishDate(item.getString("material_installation_finished"));
//								contractorForBidWorkStatus
//										.setMaterialInstallStartDate(item.getString("material_installation_start"));
//								contractorForBidWorkStatus
//										.setConWorkStartedDate(item.getString("contractor_work_started"));
//								contractorForBidWorkStatus
//										.setConWorkCompleteDate(item.getString("expected_work_completion_date"));
//								ContractorForBidWorkStatus save = contractorForBidWorkStatusRepository
//										.save(contractorForBidWorkStatus);
//								if (consumerApp.getSchemeType().getSchemeTypeId().equals(1L)) {
//									consumerApp.setApplicationStatus(applicationStatusRepository
//											.findById(ApplicationStatusEnum.PENDING_FOR_WORK_ORDER.getId()).get());
//								} else {
//									consumerApp.setApplicationStatus(applicationStatusRepository
//											.findById(ApplicationStatusEnum.PENDING_FOR_WORK_COMPLETION.getId()).get());
//								}
//								consumerApplicationDetailRepository.save(consumerApp);
							}
							break; // No need to continue searching if application found
						}
					}
					if (!applicationFound) {
						System.out.println(
								"Application not found in tkc/bid_not_participated_docs: " + consumerApplicationNo);
					}
				}
				System.out
						.println("Total application fetched from DSP Database : " + saveContractorExpectedDates.size());
				System.out.println("Total applications where contractor did not take action: " + notActionedCount);
				System.out.println("Total applications rejected by contractor: " + rejectedCount);
				System.out.println("Total applications accepted by contractor: " + acceptedCount);
			}
			return ResponseEntity.ok(null);
		} catch (HttpClientErrorException.NotAcceptable ex) {
			return ResponseEntity.status(ex.getRawStatusCode()).body(ex.getResponseBodyAsString());
		} catch (Exception ex) {
			return ResponseEntity.status(500).body("Internal Server Error");
		}
	}

	

}