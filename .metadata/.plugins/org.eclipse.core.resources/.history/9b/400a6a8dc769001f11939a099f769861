package com.TestMapping.controller;

import java.io.ByteArrayOutputStream;

import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.element.Paragraph;

@RestController
public class PdfController {

    @GetMapping("/generate-pdf")
    public ResponseEntity<byte[]> generatePdf() {
        try (ByteArrayOutputStream baos = new ByteArrayOutputStream()) {
            // Create a PdfWriter instance
            PdfWriter writer = new PdfWriter(baos);

            // Create a PdfDocument instance
            PdfDocument pdfDoc = new PdfDocument(writer);

            // Create a Document instance
            Document document = new Document(pdfDoc);

            // Add content to the PDF
            document.add(new Paragraph("Hello, World! This is a PDF document generated using iText 7 in Spring Boot."));

            // Close the document
            document.close();

            // Convert ByteArrayOutputStream to a byte array
            byte[] pdfBytes = baos.toByteArray();

            // Set the content type and header for the PDF
            HttpHeaders headers = new HttpHeaders();
            headers.setContentType(MediaType.APPLICATION_PDF);
            headers.setContentDispositionFormData("attachment", "generated.pdf");

            // Return the PDF as a response entity
            return new ResponseEntity<>(pdfBytes, headers, HttpStatus.OK);
        } catch (Exception e) {
            e.printStackTrace();
            return new ResponseEntity<>(HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }
}
